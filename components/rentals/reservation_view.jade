template(name='reservation_view')
    with current_doc
        .ui.stackable.padded.grid
            .row
                .four.wide.column 
                    with rental
                        a.ui.fluid.button(href="/rental/#{_id}/view")
                            .ui.header
                                i.left.chevron.icon
                                |#{title}
                        +image_view key='image' label='image' direct=true
                .eight.wide.column 
                    .ui.header 
                        |viewing reservation
    
                    a.ui.header.inline.lowercase(href="/reservation/#{_id}/view")
                        small from 
                        |{{cal_time start_datetime}}
                        small to 
                        |{{cal_time end_datetime}}
                    .ui.header 
                        +i name='money' classes='ui tiny inline image'
                        |estimated dollars #{hour_duration}*#{rental.hourly_dollars} = $#{estimated_dollars}
                    .ui.header final cost will be based on actual checked out time
                    if complete 
                        .ui.large.green.label complete 
                    else 
                        .ui.basic.large.label ongoing (incomplete)
                    .ui.small.header #{when} by #{_author_username}
                    +number_view key='hour_duration' label='hour duration' direct=true
                    .ui.header estimated cost #{hour_duration}*#{rental.hourly_dollars} = $#{estimated_dollars}
                    .ui.header by #{_author_username}
                    +reservation_events
                .four.wide.column
                    if can_edit
                        a.ui.big.fluid.button(href="/reservation/#{_id}/edit" title='edit reservation')
                            +i name='pencil'
                            |edit
                    .ui.divider
                    .ui.header 
                        +i name='request-money'
                        |payouts
                    .ui.header 
                        +i name='money' classes='ui tiny inline image'
                        | #{hour_duration}hrs * $#{rental.hourly_dollars}/hr = $#{estimated_dollars}
                    .ui.header 
                        +i name='payroll'
                        small 50% owner payout 
                        |$#{owner_payout}
                    .ui.header 
                        +i name='get-cash'
                        small 40% handler payout
                        | $#{handler_payout}
                    .ui.header 
                        +i name='tax'
                        small taxes
                        | $#{taxes_payout}
                    .ui.divider
                    .ui.header 
                        small your balance
                        +i name='cheap-2--v1' 
                        |#{currentUser.credit} 
                    .ui.header
                        small reservation cost 
                        |#{estimated_dollars} 
                    .ui.header 
                        small balance after purchase 
                        +i name='cheap-2--v1' 
                        |#{member_balance_after_reservation}


template(name='reservation_events')
    .ui.header
        i.rss.icon
        |reservation events
    .ui.bulleted.list
        each log_events
            .item #{text} #{when}

    
    
template(name='key_value_edit')
    .ui.button.set_key_value(class=set_key_value_class)
        |#{label}
